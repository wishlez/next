generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "mysql"
    url      = env("DATABASE_URL")
}

model User {
    id       Int       @id @default(autoincrement())
    login    String    @unique @db.VarChar(64)
    name     String    @db.VarChar(64)
    password String    @db.VarChar(64)
    Account  Account[]
    Tag      Tag[]
}

enum AccountTypes {
    Asset
    Expense
    Revenue
    Equity
    Liability
}

model AccountType {
    type    AccountTypes @id @unique
    Account Account[]
}

model Account {
    id                Int          @id @default(autoincrement())
    name              String       @db.VarChar(32)
    openingBalance    Decimal      @default(0) @db.Decimal(10, 2)
    maximumAmountOwed Decimal      @default(0) @db.Decimal(10, 2)
    builtIn           Boolean      @default(false)
    accountType       AccountTypes
    userId            Int
    AccountType       AccountType  @relation(fields: [accountType], references: [type], onDelete: Cascade, onUpdate: Cascade)
    User              User         @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)

    @@unique([name, userId])
}

model Tag {
    id     Int    @id @default(autoincrement())
    name   String
    userId Int
    User   User   @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)

    @@unique([name, userId])
}
